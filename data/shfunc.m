function [L,dLds,dLdt]=shfunc(n, s, t)

  so = ones(size(s)) ;
  sz = zeros(size(s)) ;
  if ( n == 3 )
    L    = [1-s-t  s  t] ;
    dLds = [ -so    so  sz] ;
    dLdt = [ -so    sz  so] ;
    return ;
  endif


  if ( n == 6 )
    L = [2.0.*(1.0-s-t).*(0.5-s-t) 2.0.*s.*(s-0.5) 2.0.*t.*(t-0.5) ...
	 4.0.*s.*(1.0-s-t) 4.0.*s.*t 4.0.*t.*(1.0-s-t)] ;

    dLds = [-3.0 + 4.0.*s + 4.0.*t ...
	    -1.0 + 4.0.*s  zeros(size(s)) ...
			   4.0 - 8.0.*s - 4.0.*t ...
					      4.0.*t ...
	    -4.0.*t ] ;

    dLdt = [-3.0 + 4.0.*s + 4.0.*t ...
				 zeros(size(s)) ...
	    -1.0 + 4.0.*t ...
	    -4.0.*s ...
		   4.0.*s ...
			 4.0 - 4.0.*s - 8.0.*t] ;    
    return ;
  endif
